name: add-internal-note
description: Agent opens first conversation and adds an internal note
steps:
  - type: goto
    url: env.KAYAKO_AGENT_URL
  - type: expect-visible
    selectorKey: login.submitButton
  - type: fill
    selectorKey: login.emailInput
    value: env.KAYAKO_USERNAME
  - type: fill
    selectorKey: login.passwordInput
    value: env.KAYAKO_PASSWORD
  - type: click
    selectorKey: login.submitButton
  - type: goto
    url: env.KAYAKO_CONVERSATIONS_URL
  - type: expect-visible
    selectorKey: inbox.conversationSubject
  - type: click
    selectorKey: inbox.conversationSubject
  - type: wait-loadstate
    state: networkidle
    optional: true
  - type: expect-visible
    selectorKey: conversation.subjectHeading
  - type: wait
    value: "1500"
  - type: expect-visible
    selectorKey: composer.editor
  - type: click
    selectorKey: composer.editor
  - type: wait
    value: "400"
  - type: dispatch-click-text
    value: "Notes"
  - type: wait
    value: "400"
  - type: expect-visible
    selectorKey: composer.notePlaceholder
  - type: fill
    selectorKey: composer.editor
    value: "[AUTOTEST] Internal note added by MCP"
  - type: click
    selectorKey: composer.sendButton
  - type: expect-visible
    selectorKey: conversation.noteText
  - type: wait
    value: "5000"


